# TrickBot
Decoders for TrickBot's elements<br/>

+ <b>trick_decoder.py</b> - decodes TrickBot's core modules (32/64-bit bots) - from resources of the TrickBot loader executable (obsolete, works for the first version of TrickBot)
+ <b>trick_config_decoder.py</b> - decodes TrickBot's hardcoded configuration (from the resource) + downloaded modules and their configuration
+ <b>trick_settings_decoder.py</b> - decodes BotKey and mcconfig from the settings file (i.e. _settings.ini_ dropped in the TrickBot installation directory)
+ <b>make_bot_key.cpp</b> - a keygen for BotKey (must be run on the infected machine). Compiled version: [make_bot_key.exe](https://goo.gl/7Sf1E1)

2018-10-15: The new version of TrickBot came with some changes. Now, in order to be able to decrypt modules and their configuration, you need to supply an individual key, that is generated per victim machine (referenced as BotKey).</br>

**The BotKey can be obtained in two ways:**
1) decoded:
    + Use `trick_settings_decoder.py` and the settings file dropped by TrickBot.
2) generated:
    + Compile `make_bot_key.cpp` (or download [make_bot_key.exe](https://goo.gl/7Sf1E1) ) and run it on the same machine, where the encrypted files were dropped.
  
Then, you can pass the obtained key to `trick_config_decoder.py`. 

Example:
```
./trick_config_decoder.py --botkey 2E9EA9FE45FDBA4289F494AF959FAB1A828948E19309DD3C80AD4202728821DB --datafile Data/injectDll32
Decoded: 1390000 bytes
Dumped decoded to: Data/injectDll32.out
Extracted Module to: Data/injectDll32.dll
```

**Decoding the BotKey and mcconfig**

Example:
```
./trick_settings_decoder.py --file ~/settings.ini --brute
Searching the charset...
[+] Decoded with matching charset: HJIA/CB+FGKLNOP3RSlUVWXYZfbcdeaghi5kmn0pqrstuvwx89o1246EQzTMy7Dj

<mcconf>
<ver>1000499</ver>
<gtag>tt0002</gtag>
<servs>
<srv>5.182.210.226:443</srv>
<srv>82.146.62.52:443</srv>
<srv>193.26.217.243:443</srv>
[...]
<srv>171.100.142.238:449</srv>
<srv>186.232.91.240:449</srv>
<srv>181.196.207.202:449</srv>
</servs>
<autorun>
<module name="pwgrab"/>
</autorun>
</mcconf>

2E9EA9FE45FDBA4289F494AF959FAB1A828948E19309DD3C80AD4202728821DB 281780726 12 16 20

```

Demo
---
Detailed instructions how to use it demonstrated on the video:
+ https://www.youtube.com/watch?v=7Txg46Dig9c
